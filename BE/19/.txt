// Crear una base de datos
use ecommerce

// Crear coleciones "mensajes" y "productos"
db.createCollection("mensajes")
db.createCollection("productos")

// Insert 10 documentos en la coleccion de mensajes
db.mensajes.insert({email: "test10@email.com", texto: "texto 1"})
db.mensajes.insert({email: "test10@email.com", texto: "texto 2"})
db.mensajes.insert({email: "test10@email.com", texto: "texto 3"})
db.mensajes.insert({email: "test10@email.com", texto: "texto 4"})
db.mensajes.insert({email: "test10@email.com", texto: "texto 5"})
db.mensajes.insert({email: "test10@email.com", texto: "texto 6"})
db.mensajes.insert({email: "test10@email.com", texto: "texto 7"})
db.mensajes.insert({email: "test10@email.com", texto: "texto 8"})
db.mensajes.insert({email: "test10@email.com", texto: "texto 9"})
db.mensajes.insert({email: "test10@email.com", texto: "texto 10"})

// Insert 10 docuemntos en la coleccion de productos
db.productos.insert({title: "titulo 11", price: 1000, thumbnail: "url//11"})
db.productos.insert({title: "titulo 11", price: 532, thumbnail: "url//11"})
db.productos.insert({title: "titulo 11", price: 123, thumbnail: "url//11"})
db.productos.insert({title: "titulo 11", price: 1212, thumbnail: "url//11"})
db.productos.insert({title: "titulo 11", price: 2423, thumbnail: "url//11"})
db.productos.insert({title: "titulo 11", price: 4120, thumbnail: "url//11"})
db.productos.insert({title: "titulo 11", price: 5000, thumbnail: "url//11"})
db.productos.insert({title: "titulo 11", price: 3412, thumbnail: "url//11"})
db.productos.insert({title: "titulo 11", price: 4231, thumbnail: "url//11"})
db.productos.insert({title: "titulo 11", price: 1234, thumbnail: "url//11"})

// Listar todos los documentos de cada coleccion
db.mensajes.find()
db.productos.find()

// Retornar la cantidad de docuemntos de cada coleccion
db.mensajes.estimatedDocumentCount()
db.productos.estimatedDocumentCount()

// Agregar un prodcuto mas en la coleccion de productos
db.productos.insert({title: "titulo 11", price: 123, thumbnail: "url//11"})

// Listar productos con precio menor a 1000
db.productos.find({"price": {$lt: 1000}})

// Listar productos con precio entre 1000 a 3000
db.productos.find({$and:[{"price": {$gte: 1000}}, {"price": {$lte: 3000}}]})

// Listar productos con precio mayor a 3000
db.productos.find({"price": {$gt: 3000}})

// Trae el nombre del tercer producto mas barato
db.productos.find().skip(2).limit(1).sort({price: 1})

// Actualizar todos los productos agregando stock = 100
 db.productos.updateMany({"price": {$gte: 0}},{$set: {"stock": 100}})

// Cambiar a 0 el stock de los prodcutos con precio mayor a 4000
db.productos.updateMany({"price": {$gt: 4000}},{$set: {"stock": 0}})

// borrar los productos con precio menor a 1000
db.productos.deleteMany({"price": {$lt: 1000}})

// Crear un usuario llamado "pepe" con la clave "asd456" con permisos de solo lectura en la base ecommerce.
db.createUser(
    {
        user: "pepe",
        pwd: "asd456",
        roles: [
            {
                role: "read",
                db: "ecommerce" 
            }
        ]
    }
)

// Exportar data
mongoexport --collection=mensajes --db=ecommerce --out=mensajes.json
mongoexport --collection=productos --db=ecommerce --out=productos.json